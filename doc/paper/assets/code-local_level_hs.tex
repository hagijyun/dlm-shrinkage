\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{data} \PY{p}{\PYZob{}}
  \PY{k+kt}{int} \PY{n}{n}\PY{p}{;}
  \PY{k+kt}{real} \PY{n}{y}\PY{p}{[}\PY{n}{n}\PY{p}{]}\PY{p}{;}
  \PY{k+kt}{real} \PY{n}{a1}\PY{p}{;}
  \PY{k+kt}{real}\PY{p}{\PYZlt{}}\PY{k+kr}{lower}\PY{o}{=}\PY{l+m+mf}{0.0}\PY{p}{\PYZgt{}} \PY{n}{P1}\PY{p}{;}
\PY{p}{\PYZcb{}}
\PY{k+kn}{parameters} \PY{p}{\PYZob{}}
  \PY{k+kt}{real}\PY{p}{\PYZlt{}}\PY{k+kr}{lower}\PY{o}{=}\PY{l+m+mf}{0.0}\PY{p}{\PYZgt{}} \PY{n}{H}\PY{p}{;}
  \PY{k+kt}{real}\PY{p}{\PYZlt{}}\PY{k+kr}{lower}\PY{o}{=}\PY{l+m+mf}{0.0}\PY{p}{\PYZgt{}} \PY{n}{tau}\PY{p}{;}
  \PY{k+kt}{vector}\PY{p}{\PYZlt{}}\PY{k+kr}{lower}\PY{o}{=}\PY{l+m+mf}{0.0}\PY{p}{\PYZgt{}}\PY{p}{[}\PY{n}{n}\PY{p}{]} \PY{n}{lambda}\PY{p}{;}
\PY{p}{\PYZcb{}}
\PY{k+kn}{transformed parameters} \PY{p}{\PYZob{}}
  \PY{k+kt}{vector}\PY{p}{\PYZlt{}}\PY{k+kr}{lower}\PY{o}{=}\PY{l+m+mf}{0.0}\PY{p}{\PYZgt{}}\PY{p}{[}\PY{n}{n}\PY{p}{]} \PY{n}{Q}\PY{p}{;}
  \PY{k+kr}{for} \PY{p}{(}\PY{n}{i} \PY{k+kr}{in} \PY{l+m+mi}{1}\PY{p}{:}\PY{n}{n}\PY{p}{)} \PY{p}{\PYZob{}}
    \PY{n}{Q}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{p}{\PYZlt{}}\PY{o}{\PYZhy{}} \PY{n+nb}{pow}\PY{p}{(}\PY{n}{lambda}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{l+m+mf}{2.0}\PY{p}{)} \PY{o}{*} \PY{n+nb}{pow}\PY{p}{(}\PY{n}{tau}\PY{p}{,} \PY{l+m+mf}{2.0}\PY{p}{)}\PY{p}{;}
  \PY{p}{\PYZcb{}}
\PY{p}{\PYZcb{}}
\PY{k+kn}{model} \PY{p}{\PYZob{}}
  \PY{p}{\PYZob{}}
    \PY{k+kt}{real} \PY{n}{loglik\PYZus{}obs}\PY{p}{[}\PY{n}{n}\PY{p}{]}\PY{p}{;}
    \PY{k+kt}{real} \PY{n}{a}\PY{p}{;}
    \PY{k+kt}{real} \PY{n}{P}\PY{p}{;}
    \PY{k+kt}{real} \PY{n}{v}\PY{p}{;}
    \PY{k+kt}{real} \PY{n}{K}\PY{p}{;}
    \PY{k+kt}{real} \PY{n}{F}\PY{p}{;}
    \PY{k+kt}{real} \PY{n}{Finv}\PY{p}{;}
    \PY{n}{a} \PY{p}{\PYZlt{}}\PY{o}{\PYZhy{}} \PY{n}{a1}\PY{p}{;}
    \PY{n}{P} \PY{p}{\PYZlt{}}\PY{o}{\PYZhy{}} \PY{n}{P1}\PY{p}{;}
    \PY{k+kr}{for} \PY{p}{(}\PY{n}{i} \PY{k+kr}{in} \PY{l+m+mi}{1}\PY{p}{:}\PY{n}{n}\PY{p}{)} \PY{p}{\PYZob{}}
      \PY{n}{v} \PY{p}{\PYZlt{}}\PY{o}{\PYZhy{}} \PY{n}{y}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{a}\PY{p}{;}
      \PY{n}{F} \PY{p}{\PYZlt{}}\PY{o}{\PYZhy{}} \PY{n}{P} \PY{o}{+} \PY{n}{H}\PY{p}{;}
      \PY{n}{Finv} \PY{p}{\PYZlt{}}\PY{o}{\PYZhy{}} \PY{l+m+mi}{1} \PY{o}{/} \PY{n}{F}\PY{p}{;}
      \PY{n}{K} \PY{p}{\PYZlt{}}\PY{o}{\PYZhy{}} \PY{n}{P} \PY{o}{*} \PY{n}{Finv}\PY{p}{;}
      \PY{n}{a} \PY{p}{\PYZlt{}}\PY{o}{\PYZhy{}} \PY{n}{a} \PY{o}{+} \PY{n}{K} \PY{o}{*} \PY{n}{v}\PY{p}{;}
      \PY{n}{P} \PY{p}{\PYZlt{}}\PY{o}{\PYZhy{}} \PY{p}{(}\PY{l+m+mi}{1} \PY{o}{\PYZhy{}} \PY{n}{K} \PY{p}{)} \PY{o}{*} \PY{n}{P}\PY{p}{;}
      \PY{n}{loglik\PYZus{}obs}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{p}{\PYZlt{}}\PY{o}{\PYZhy{}} \PY{l+m+mf}{\PYZhy{}0.5} \PY{o}{*} \PY{p}{(}\PY{n+nb}{log}\PY{p}{(}\PY{l+m+mi}{2} \PY{o}{*} \PY{k+kc}{pi}\PY{p}{(}\PY{p}{)}\PY{p}{)}
                               \PY{o}{+} \PY{n+nb}{log}\PY{p}{(}\PY{n}{F}\PY{p}{)} \PY{o}{+} \PY{n}{Finv} \PY{o}{*} \PY{n+nb}{pow}\PY{p}{(}\PY{n}{v}\PY{p}{,} \PY{l+m+mf}{2.0}\PY{p}{)}\PY{p}{)}\PY{p}{;}
      \PY{n}{P} \PY{p}{\PYZlt{}}\PY{o}{\PYZhy{}} \PY{n}{P} \PY{o}{+} \PY{n}{Q}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{;}
    \PY{p}{\PYZcb{}}
    \PY{n+nb+bp}{lp\PYZus{}\PYZus{}} \PY{p}{\PYZlt{}}\PY{o}{\PYZhy{}} \PY{n+nb}{sum}\PY{p}{(}\PY{n}{loglik\PYZus{}obs}\PY{p}{)}\PY{p}{;}
  \PY{p}{\PYZcb{}}
  \PY{n+nb+bp}{lp\PYZus{}\PYZus{}} \PY{p}{\PYZlt{}}\PY{o}{\PYZhy{}} \PY{n+nb+bp}{lp\PYZus{}\PYZus{}} \PY{o}{\PYZhy{}} \PY{n+nb}{log}\PY{p}{(}\PY{n}{H}\PY{p}{)}\PY{p}{;}
  \PY{n}{tau} \PY{o}{\PYZti{}} \PY{n+nb}{cauchy}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n+nb}{sqrt}\PY{p}{(}\PY{n}{H}\PY{p}{)}\PY{p}{)}\PY{p}{;}
  \PY{n}{lambda} \PY{o}{\PYZti{}} \PY{n+nb}{cauchy}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{;}
\PY{p}{\PYZcb{}}
\end{Verbatim}
